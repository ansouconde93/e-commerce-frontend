<div class="login-page" *ngIf ="mode == 0">
    <mat-card class="mat-elevation-z12 matcad">
      <br>
      <mat-card-title style="text-align:center;">Connexion | Inscription</mat-card-title>
      <mat-tab-group mat-stretch-tabs class="example-stretched-tabs">
        <br>
        <mat-tab label="Connexion">
            <mat-card-content>
              <form #f ="ngForm" (ngSubmit)="onLogin(f.value)">
                <mat-form-field>
                  <input
                    matInput
                    type="email"
                    pattern="[a-z0-9._%+-]{1,}@[a-z0-9.-]{2,}[.][a-z]{2,}"
                    placeholder="Email"
                    required
                    name="username"
                    ngModel
                    #username="ngModel">
                    <mat-error *ngIf="username.invalid">Email est obligatoire</mat-error>
                  <mat-icon matSuffix>email</mat-icon>
                </mat-form-field>
                <br>
                <mat-form-field>
                  <input
                    matInput
                    placeholder="Mot de passe"
                    type="password"
                    required
                    minlength="2"
                    name="password"
                    ngModel
                    #password="ngModel">
                    <mat-error
                      *ngIf="password.errors && password.errors.required">
                      Mot de passe est obligatoire
                    </mat-error>
                    <mat-error
                      *ngIf="password.errors && password.errors.minlength">
                      Mot de passe supérieur ou égal à 2
                    </mat-error>
                  <mat-icon matSuffix>lock</mat-icon>
                </mat-form-field>
                <br>
                <mat-checkbox ngModel name="rememberMe">Se souvenir de moi !</mat-checkbox>
                <br>
                <button
                  mat-raised-button *ngIf=" !username.invalid && ! password.invalid"
                  type="submit"
                  color="primary"
                  class="login-button">
                  Se connecter
                </button>
              </form>
            </mat-card-content>
        </mat-tab>

        <!-- Partie pour l'inscription-->
        <mat-tab label="Inscription">
          <mat-card-content>
            <form #client ="ngForm" (ngSubmit)="onAddCLient(client.value)">
              <mat-form-field>
                <input
                  matInput
                  type="text"
                  placeholder="Nom utilisateur"
                  required
                  name="name"
                  ngModel
                  #name="ngModel">
                <mat-icon matSuffix>perm_identity</mat-icon>
                <mat-error
                  *ngIf="name.invalid">
                  Votre nom est obligatoire
                </mat-error>  
              </mat-form-field>
              <mat-form-field>
                <input
                  matInput
                  type="tel"
                  placeholder="Numéro de téléphone"
                  minlength="8"
                  required
                  name="phoneNumber"
                  ngModel
                  #phoneNumber="ngModel">
                <mat-icon matSuffix>perm_phone_msg</mat-icon>
                <mat-error
                  *ngIf="phoneNumber.invalid">
                  Votre numéro de téléphone est obligatoire
                </mat-error>  
              </mat-form-field>
              <mat-form-field>
                <input
                  matInput
                  type="text"
                  placeholder="Adresse(numéro de : Rue, maison,...)"
                  required
                  name="address"
                  ngModel
                  #address="ngModel">
                <mat-icon matSuffix>room</mat-icon>
                <mat-error
                  *ngIf="address.invalid">
                  Votre addresse est obligatoire
                </mat-error>  
              </mat-form-field>
              <mat-form-field>
                <input
                  matInput
                  type="text"
                  placeholder="Pays"
                  required
                  name="country"
                  ngModel
                  #country="ngModel">
                <mat-icon matSuffix>location_city</mat-icon>
                <mat-error
                  *ngIf="country.invalid">
                  Le nom de votre pays est obligatoire
                </mat-error>  
              </mat-form-field>
              <mat-form-field>
                <input
                  matInput
                  type="text"
                  placeholder="Code postale"
                  required
                  name="zipCode"
                  ngModel
                  #zipCode="ngModel">
                <mat-icon matSuffix>perm_device_information</mat-icon>
                <mat-error
                  *ngIf="zipCode.invalid">
                  Le code postale est obligatoire
                </mat-error>  
              </mat-form-field>
              <mat-form-field>
                <input
                  matInput
                  type="email"
                  pattern="[a-z0-9._%+-]{1,}@[a-z0-9.-]{2,}[.][a-z]{2,}"
                  placeholder="Email"
                  required
                  name="username"
                  ngModel
                  #username="ngModel">
                  <mat-error *ngIf="username.invalid">Email est obligatoire</mat-error>
                <mat-icon matSuffix>email</mat-icon>
              </mat-form-field>
              <mat-form-field>
                <input
                  matInput
                  placeholder="Mot de passe"
                  type="password"
                  required
                  minlength="2"
                  name="password"
                  ngModel
                  #password="ngModel">
                  <mat-error
                    *ngIf="password.errors && password.errors.required">
                    Mot de passe est obligatoire
                  </mat-error>
                  <mat-error
                    *ngIf="password.errors && password.errors.minlength">
                    Mot de passe supérieur ou égal à 2
                  </mat-error>
                <mat-icon matSuffix>lock</mat-icon>  
              </mat-form-field>
              <mat-form-field>
                  <input
                  matInput
                  placeholder="Retapper le mot de passe"
                  type="password"
                  required
                  minlength="2"
                  name="repassword"
                  ngModel
                  #repassword="ngModel">
                  <mat-error
                    *ngIf="repassword.errors && repassword.errors.required">
                    Confirmez le mot de passe
                  </mat-error>                  
                <mat-icon matSuffix>lock</mat-icon>
              </mat-form-field>

              <mat-checkbox *ngIf="actionToDo == 0" ngModel name="roleUser" >Client ?
              </mat-checkbox>
              <mat-checkbox *ngIf="actionToDo == 0" ngModel name="roleAdmin">Administrateur ?
              </mat-checkbox>

                <button
                  mat-raised-button
                  *ngIf="client.valid==true && client.value.password == client.value.repassword"
                  type="submit"
                  color="primary"
                  class="login-button">
                  {{validedButton}}
                </button>
            </form>
          </mat-card-content>
        </mat-tab>
      </mat-tab-group>
    </mat-card>
</div>

<!--Part to display order recap-->

<div class="login-page" *ngIf ="mode == 1 || mode == 2">
    <mat-card class="recap-card">
      <mat-card-header>
        <mat-card-title>
          <b *ngIf="mode == 1">Recapitulatif de votre commande</b>
          <div *ngIf="mode == 2 && middleMode ==0" 
            style="display: block; margin-left: auto; margin-right: auto; background-color: #16b84e; width: 100%; border-radius: 10px;">
            <br>
            <div tyle="display: block; margin-left: 3%;margin-right: 3%; margin-top: 2%; margin-bottom: 2%;">
              <b style="color: white; font-weight: bold;"> &nbsp; Commande bien reçu de numéro : </b>
              <b style="color: white; font-weight: bold;"><u>{{commandeService.commande.id}}</u>
                et non encore payé. &nbsp;</b>
            </div>
            <br>
          </div>

          <div *ngIf="mode == 2 && middleMode ==1" 
            style="display: block; background-color: hsl(141, 79%, 40%); width: 100%; border-radius: 10px;">
            <br>
            <div style="display: block; margin-left: 3%;margin-right: 3%; margin-top: 2%; margin-bottom: 2%;">
              <b style="color: white; font-weight: bold;">La commande numéro : </b>
              <b style="color: white; font-weight: bold;"><u>{{commandeService.commande.id}}</u>
                , a été bien reçu et payé. Nous vous remercions d'avoir nous portez confience.</b>
              <mat-icon style="color: white; font-weight: bold;">check</mat-icon>
              <br>
            </div>
            <br>
          </div>
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <table>
          <tr>
            <td>Nom</td><td> </td><td> </td><td>{{client.name}}</td>
          </tr>
          <tr>
            <td>Téléphone</td><td> </td><td> </td><td>{{client.phoneNumber}}</td>
          </tr>
          <tr>
            <td>Pays</td><td> </td><td> </td><td>{{client.country}}</td>
          </tr>
          <tr>
            <td>Code postale</td><td> </td><td> </td><td>{{client.zipCode}}</td>
          </tr>
          <tr>
            <td>Adresse</td><td> </td><td> </td><td>{{client.address}}</td>
          </tr>
          <tr>
            <td>Email</td><td> </td><td> </td><td>{{client.username}}</td>
          </tr>
        </table>
        <br>
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z2">
              <!-- Id Column -->
              <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> ID </th>
                <td mat-cell *matCellDef="let transaction"> {{transaction.id}} </td>
                <td mat-footer-cell *matFooterCellDef> Totaux </td>
              </ng-container>

              <!-- Nom Column -->
              <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef> Nom </th>
                  <td mat-cell *matCellDef="let transaction"> {{transaction.name}} </td>
                  <td mat-footer-cell *matFooterCellDef> </td>
              </ng-container>

              <!-- quantity Column -->
              <ng-container matColumnDef="quantite">
                  <th mat-header-cell *matHeaderCellDef> Quantite </th>
                  <td mat-cell *matCellDef="let transaction"> {{transaction.quantite}} </td>
                  <td mat-footer-cell *matFooterCellDef> </td>
                </ng-container>
            
              <!-- prix Column -->
              <ng-container matColumnDef="price">
                <th mat-header-cell *matHeaderCellDef> Prix </th>
                <td mat-cell *matCellDef="let transaction"> {{transaction.price | number:'0.3'}} </td>
                <td mat-footer-cell *matFooterCellDef> {{commandeService.getTotalPrice() | number:'0.3'}} </td>
              </ng-container>
              
              <!-- remise Column -->
              <ng-container matColumnDef="remise">
                  <th mat-header-cell *matHeaderCellDef> Remise </th>
                  <td mat-cell *matCellDef="let transaction"> {{transaction.remise | number:'0.3'}} </td>
                  <td mat-footer-cell *matFooterCellDef> {{commandeService.getTotalRemise() | number:'0.3'}} </td>
                </ng-container>
            
              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
              <tr mat-footer-row *matFooterRowDef="displayedColumns; sticky: true"></tr>
          </table>
      </mat-card-content>

      <mat-card-actions>
          <button mat-raised-button 
            color="primary" (click) ="gotToSaveOrder(0)"
            *ngIf="mode == 1">
            Confim order
          </button>
          <button mat-raised-button 
            style="background-color: #16b84e; color: white;" (click) ="gotToPaiedForm()"
            *ngIf="mode == 1">
            Paied now
          </button>
          
          <button mat-raised-button 
            color="primary" (click) ="gotToHomePage()"
            *ngIf="mode == 2">
            Explore new products
          </button>
          <button mat-raised-button 
            style="background-color: #16b84e; color: white;" (click) ="gotToPaiedForm()"
            *ngIf="mode == 2 && middleMode ==0">
            Paied now
          </button>
          <br><br>
      </mat-card-actions>
    </mat-card>
</div>

<!--Part for given payment card information -->
<div class="login-page" *ngIf ="mode == 3 || mode ==4">
  <mat-card class="mat-elevation-z12 matcad">
      <mat-card-content>
        <form #cardP ="ngForm" (ngSubmit)="readCardInformation(cardP.value)">
          <mat-form-field>
            <mat-label>Choisir le type de votre carte</mat-label>
            <mat-select ngModel name="cardType" required #cardType ="ngModel">
              <mat-option *ngFor="let cardT of typeCarte" [value]="cardT"> {{ cardT }}</mat-option>  
            </mat-select>            
            <mat-icon matSuffix>card_membership</mat-icon>
            <mat-error
                *ngIf="cardType.invalid">
                Type de la carte est obligatoire
            </mat-error>
          </mat-form-field>                
            
          <mat-form-field>
              <input
                matInput
                type="text"
                placeholder="Numéro de la carte"
                minlength="8"
                required
                name="cardNumber"
                ngModel
                #cardNumber="ngModel">
              <mat-icon matSuffix>card_giftcard</mat-icon>
              <mat-error
                *ngIf="cardNumber.invalid">
                Numéro de la carte est obligatoire
              </mat-error>  
            </mat-form-field>
            
            <mat-form-field>
              <input
                matInput
                type="password"
                placeholder="Mot de passe de la carte"
                required
                minlength="2"
                name="cardPassword"
                ngModel
                #cardPassword="ngModel">
                <mat-icon matSuffix>lock</mat-icon>
              <mat-error
                *ngIf="cardPassword.invalid">
                Mot de passe de la carte est obligatoire
              </mat-error>  
            </mat-form-field>
            <mat-form-field>
              <input
                matInput
                type="number"
                step="0.001"
                min="1"
                placeholder="Montant"
                required
                name="amount"
                ngModel
                #amount="ngModel">
              <mat-icon matSuffix>euro_symbol</mat-icon>
              <mat-error
                *ngIf="amount.invalid">
                Le montant est obligatoire
              </mat-error>  
            </mat-form-field>
            <div *ngIf="mode == 4" style="margin-left: 8%;">
              <span>Type de la carte : </span>&nbsp;&nbsp;&nbsp;{{paymenCardInfo.cardType}}<br>
              <span>Numéro de la carte : </span>&nbsp;&nbsp;{{paymenCardInfo.cardNumber}}<br>
              <span>Montant : </span>&nbsp;&nbsp;&nbsp;&nbsp;{{paymenCardInfo.amount}}<br>
            </div>
              <button
                mat-raised-button
                *ngIf="cardP.valid==true && mode ==3"
                type="submit"
                color="primary"
                class="login-button">
                Next
              </button>
              <button
              mat-raised-button *ngIf="mode ==4"
              type="submit"
              (click) ="saveCommande()"
              style="background-color: #16b84e; color: white;"
              class="login-button">
              Valid paiement
            </button>
            <br>
          </form>
        </mat-card-content>
  </mat-card>
</div>
                
